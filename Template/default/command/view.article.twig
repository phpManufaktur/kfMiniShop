{#
  miniShop

  @author Team phpManufaktur <team@phpmanufaktur.de>
  @link https://kit2.phpmanufaktur.de/miniShop
  @copyright 2014 Ralf Hertsch <ralf.hertsch@phpmanufaktur.de>
  @license MIT License (MIT) http://www.opensource.org/licenses/MIT
#}
{% spaceless %}
<!-- {{ _self.getTemplateName() }} -->
<div id="minishop">
  <div class="container-fluid">    
    {% include '@phpManufaktur/miniShop/Template/default/command/basket.twig' %}
    
    <h1>{{ article.article_name|default('Error'|trans) }}</h1>  
    
    {{ basic.alert }}
    
    {% if article|length > 0 %}
      <div class="article-container">
        {% if article.article_image|length > 0 %}
          {% set img = image(article.article_image, parameter.image_max_width, parameter.image_max_height) %}
          {% set img_url = img.src %}
          <a href="{{ FRAMEWORK_URL ~ article.article_image }}" data-title="{{ article.article_name }}" data-lightbox="{{ article.permanent_link }}">
            <img class="img-responsive img-rounded article-image-left" src="{{ img_url }}" alt="{{ article.article_name }}" title="{{ article.article_name }}" />
          </a>
          {% if article.article_image_folder_gallery == 1 and article.folder_images|length > 0 %}
            {% for image in article.folder_images %}
              <a href="{{ image }}" data-title="{{ article.article_name }}" data-lightbox="{{ article.permanent_link }}"></a>
            {% endfor %}
          {% endif %}  
        {% endif %}
        <div class="content">
          {{ article.description_long }}
        </div>
      </div>
        
      <div class="clearfix"></div>  
      
      {% set currency_symbol = attribute(config.currency, base.currency_iso).symbol %}
      <div class="order-container">
        <div class="info">
          <div class="price">
            <strong>{{ article.article_price|number_format(2, 'DECIMAL_SEPARATOR'|trans({},'messages',base.locale|lower), 'THOUSAND_SEPARAROR'|trans({},'messages',base.locale|lower)) }} {{ currency_symbol }}</strong>{% if base.article_price_type == 'NET_PRICE' %} {{ 'net price without tax'|trans }}{% endif %}
          </div>
          <div class="status{% if article.status == 'AVAILABLE_SOON' or article.status == 'NOT_AVAILABLE' %} locked{% endif %}">
            {{ article.status|humanize|trans }}{% if article.status == 'AVAILABLE_DATE' or article.status == 'AVAILABLE_DATE_ORDER' %} {{ article.available_date|date('DATE_FORMAT'|trans({},'messages',base.locale|lower)) }}{% endif %}
          </div>
          <div class="shipping">
            {% if base.shipping_type == 'NONE' %}
              {{ 'Pickup by the customer'|trans }}
            {% elseif base.shipping_type == 'FLATRATE' and base.shipping_flatrate <= 0 %}
              {{ 'Free of shipping costs'|trans }}
            {% elseif base.shipping_type == 'FLATRATE' and base.shipping_flatrate > 0 %}
              {% set shipping_costs = base.shipping_flatrate|number_format(2, 'DECIMAL_SEPARATOR'|trans({},'messages',base.locale|lower), 'THOUSAND_SEPARAROR'|trans({},'messages',base.locale|lower)) %}
              {{ 'Shipping costs %costs% %currency%'|trans({'%costs%':shipping_costs, '%currency%':currency_symbol }) }}
            {% elseif base.shipping_type == 'ARTICLE' and article.shipping_cost <= 0 %}
              {{ 'Free of shipping costs'|trans }}
            {% else %}
              {% set shipping_costs = article.shipping_cost|number_format(2, 'DECIMAL_SEPARATOR'|trans({},'messages',base.locale|lower), 'THOUSAND_SEPARAROR'|trans({},'messages',base.locale|lower)) %}
              {{ 'Shipping costs %costs% %currency%'|trans({'%costs%':shipping_costs, '%currency%':currency_symbol }) }}
            {% endif %}  
          </div>
        </div>
        {% if article.status != 'AVAILABLE_SOON' and article.status != 'NOT_AVAILABLE' %}  
        <form action="{{ permalink_base_url ~ '/basket/add' }}" class="form-inline" method="post" role="form">
          <div class="form-group">
            <div class="input-group">
              <div class="input-group-addon"><i class="fa fa-shopping-cart"></i></div>
                {{ form_widget(form.quantity) }}
            </div>
          </div>
          {% if form.article_variant_name.vars.value|length > 0 %}
            <div class="form-group">
              {{ form_widget(form.article_variant_values) }}
            </div>
          {% endif %}  
          {% if form.article_variant_name_2.vars.value|length > 0 %}
            <div class="form-group">
              {{ form_widget(form.article_variant_values_2) }}
            </div>
          {% endif %}          
          {{ form_rest(form) }}
          <button type="submit" class="btn btn-default input-sm" title="{{ 'Add article to the shopping basket'|trans }}"><i class="fa fa-plus"></i></button>
        </form>  
        {% endif %}
      </div>
      
      
    {% endif %}
  </div>

  <div class="switch-to-offers">
    <a href="{{ shop_url }}"><i class="fa fa-arrow-circle-left"></i> {{ 'switch to the offers'|trans }}</a>
  </div>
</div>
{% endspaceless %}